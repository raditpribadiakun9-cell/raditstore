<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TyetaPay</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif;}
  body{
    background:url('https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=1920&q=80') no-repeat center center/cover;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    overflow:hidden;
  }
  .overlay{
    position:absolute;top:0;left:0;width:100%;height:100%;
    backdrop-filter:blur(12px) brightness(0.5);
    background:rgba(0,0,0,0.4);
    z-index:0;
  }
  .app{
    position:relative;z-index:1;
    width:100%;max-width:450px;
    background:rgba(255,255,255,0.08);
    border-radius:20px;
    box-shadow:0 0 40px rgba(0,255,255,0.2);
    overflow:hidden;
    backdrop-filter:blur(20px);
    color:white;
    animation:fadeIn 1s ease;
  }
  header{
    background:rgba(0,0,0,0.3);
    color:#00bfff;
    text-align:center;
    padding:20px 0;
    font-size:26px;
    font-weight:700;
    letter-spacing:1px;
    text-shadow:0 0 10px #00bfff;
  }
  main{padding:25px;}
  .hidden{display:none;}
  .input-group{margin-bottom:18px;}
  label{font-size:14px;opacity:0.8;}
  input{
    width:100%;padding:10px;
    border:none;border-radius:8px;
    background:rgba(255,255,255,0.15);
    color:white;margin-top:5px;outline:none;
  }
  input::placeholder{color:#ccc;}
  button{
    width:100%;padding:12px;
    border:none;border-radius:8px;
    background:#00bfff;color:white;
    font-size:16px;font-weight:600;
    cursor:pointer;transition:0.3s;
  }
  button:hover{background:#0095cc;box-shadow:0 0 10px #00bfff;}
  .balance{font-size:28px;font-weight:700;color:#00bfff;margin:10px 0;text-shadow:0 0 10px #00bfff;}
  .actions button{width:32%;margin:5px 1%;font-size:14px;padding:10px;}
  .transaction{
    background:rgba(255,255,255,0.1);
    border-radius:10px;
    padding:10px;margin:6px 0;font-size:14px;
  }
  .center{text-align:center;}
  a{color:#00bfff;text-decoration:none;}
  a:hover{text-decoration:underline;}
  #loading-screen{
    position:fixed;top:0;left:0;width:100%;height:100%;
    background:#000;display:flex;
    justify-content:center;align-items:center;flex-direction:column;
    z-index:9999;
  }
  .spinner{
    border:4px solid rgba(255,255,255,0.2);
    border-top:4px solid #00bfff;
    border-radius:50%;
    width:60px;height:60px;
    animation:spin 1s linear infinite;
    margin-bottom:20px;
  }
  #loading-text{color:#00bfff;font-size:18px;letter-spacing:1px;}
  @keyframes spin{to{transform:rotate(360deg);}}
  @keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}

  /* Admin table */
  table{width:100%;border-collapse:collapse;margin-top:10px;}
  th,td{border:1px solid rgba(255,255,255,0.2);padding:6px;text-align:left;font-size:13px;}
  th{background:rgba(0,191,255,0.2);}
  td button{padding:4px 8px;font-size:12px;margin:2px;}
</style>
</head>
<body>

<div id="loading-screen">
  <div class="spinner"></div>
  <div id="loading-text">Memuat TyetaPay...</div>
</div>

<div class="overlay"></div>

<div class="app hidden" id="app">
  <header>TyetaPay</header>

  <!-- LOGIN -->
  <main id="login-page">
    <h2 class="center">Masuk ke TyetaPay</h2><br>
    <div class="input-group">
      <label>Email</label>
      <input type="email" id="login-email" placeholder="Masukkan email">
    </div>
    <div class="input-group">
      <label>Password</label>
      <input type="password" id="login-password" placeholder="Masukkan password">
    </div>
    <button onclick="login()">Masuk</button>
    <p class="center">Belum punya akun? <a href="#" onclick="showRegister()">Daftar</a></p>
  </main>

  <!-- REGISTER -->
  <main id="register-page" class="hidden">
    <h2 class="center">Daftar TyetaPay</h2><br>
    <div class="input-group">
      <label>Nama</label>
      <input type="text" id="reg-name" placeholder="Masukkan nama">
    </div>
    <div class="input-group">
      <label>Email</label>
      <input type="email" id="reg-email" placeholder="Masukkan email">
    </div>
    <div class="input-group">
      <label>Password</label>
      <input type="password" id="reg-password" placeholder="Masukkan password">
    </div>
    <button onclick="register()">Daftar</button>
    <p class="center"><a href="#" onclick="showLogin()">Sudah punya akun? Masuk</a></p>
  </main>

  <!-- DASHBOARD USER -->
  <main id="dashboard-page" class="hidden">
    <h2 class="center" id="user-name"></h2>
    <p class="center">Saldo kamu:</p>
    <p class="center balance" id="user-balance">Rp 0</p>
    <div class="actions center">
      <button onclick="topup()">Isi Saldo</button>
      <button onclick="transfer()">Transfer</button>
      <button onclick="logout()">Keluar</button>
    </div>
    <div class="history">
      <h3>Riwayat Transaksi</h3>
      <div id="transaction-list"></div>
    </div>
  </main>

  <!-- PANEL ADMIN -->
  <main id="admin-page" class="hidden">
    <h2 class="center">Panel Admin</h2>
    <p class="center">Kelola semua akun pengguna TyetaPay</p>
    <div id="admin-userlist"></div>
    <button onclick="logout()">Keluar</button>
  </main>
</div>

<script>
  window.addEventListener("load", ()=>{
    setTimeout(()=>{
      document.getElementById("loading-screen").style.display="none";
      document.getElementById("app").classList.remove("hidden");
    },1200);
  });

  const ADMIN_EMAIL = "tyetaadmin@tyetapay.com";
  const ADMIN_PASS = "radit";

  const users = JSON.parse(localStorage.getItem('tyetapay_users') || '{}');
  let currentUser = JSON.parse(localStorage.getItem('tyetapay_current') || 'null');

  const loginPage = document.getElementById('login-page');
  const registerPage = document.getElementById('register-page');
  const dashboardPage = document.getElementById('dashboard-page');
  const adminPage = document.getElementById('admin-page');

  function showLogin(){loginPage.classList.remove('hidden');registerPage.classList.add('hidden');dashboardPage.classList.add('hidden');adminPage.classList.add('hidden');}
  function showRegister(){loginPage.classList.add('hidden');registerPage.classList.remove('hidden');dashboardPage.classList.add('hidden');adminPage.classList.add('hidden');}
  function showDashboard(){loginPage.classList.add('hidden');registerPage.classList.add('hidden');dashboardPage.classList.remove('hidden');adminPage.classList.add('hidden');}
  function showAdmin(){loginPage.classList.add('hidden');registerPage.classList.add('hidden');dashboardPage.classList.add('hidden');adminPage.classList.remove('hidden');}

  function register(){
    const name=document.getElementById('reg-name').value.trim();
    const email=document.getElementById('reg-email').value.trim();
    const pass=document.getElementById('reg-password').value.trim();
    if(!name||!email||!pass) return alert('Isi semua kolom!');
    if(users[email]) return alert('Email sudah terdaftar!');
    users[email]={name,email,pass,balance:0,history:[],banned:false};
    localStorage.setItem('tyetapay_users',JSON.stringify(users));
    alert('Pendaftaran berhasil!');
    showLogin();
  }

  function login(){
    const email=document.getElementById('login-email').value.trim();
    const pass=document.getElementById('login-password').value.trim();

    if(email===ADMIN_EMAIL && pass===ADMIN_PASS){
      currentUser={email:ADMIN_EMAIL,name:"Admin",role:"admin"};
      localStorage.setItem('tyetapay_current',JSON.stringify(currentUser));
      loadAdmin();
      return;
    }

    if(!users[email]) return alert('Akun tidak ditemukan!');
    if(users[email].banned) return alert('Akun ini telah dibanned oleh admin!');
    if(users[email].pass!==pass) return alert('Password salah!');
    currentUser=users[email];
    localStorage.setItem('tyetapay_current',JSON.stringify(currentUser));
    loadDashboard();
  }

  function loadDashboard(){
    document.getElementById('user-name').innerText=currentUser.name;
    document.getElementById('user-balance').innerText='Rp '+currentUser.balance.toLocaleString();
    const list=document.getElementById('transaction-list');
    list.innerHTML=currentUser.history.map(h=>`<div class='transaction'>${h}</div>`).join('');
    showDashboard();
  }

  function saveUser(){
    users[currentUser.email]=currentUser;
    localStorage.setItem('tyetapay_users',JSON.stringify(users));
    localStorage.setItem('tyetapay_current',JSON.stringify(currentUser));
  }

  function topup(){
    if(currentUser.email===ADMIN_EMAIL){
      alert("Admin tidak bisa top up untuk diri sendiri.");
      return;
    }
    const wa = "https://wa.me/6289603266259?text=Halo%20Admin%2C%20saya%20ingin%20isi%20saldo%20TyetaPay.";
    if(confirm("User tidak bisa isi saldo sendiri.\nHubungi admin untuk top up via WhatsApp?")){
      window.open(wa, "_blank");
    }
  }

  function transfer(){
    const to=prompt('Masukkan email tujuan');
    if(!users[to]) return alert('Tujuan tidak ditemukan!');
    if(users[to].banned) return alert('Akun tujuan dibanned!');
    const amount=parseInt(prompt('Jumlah transfer (Rp)'));
    if(isNaN(amount)||amount<=0) return alert('Jumlah tidak valid!');
    if(currentUser.balance<amount) return alert('Saldo tidak cukup!');
    currentUser.balance-=amount;
    users[to].balance+=amount;
    const msg=`Transfer ke ${to}: Rp${amount.toLocaleString()}`;
    currentUser.history.unshift(`- Rp${amount.toLocaleString()} ke ${to}`);
    users[to].history.unshift(`+ Rp${amount.toLocaleString()} dari ${currentUser.email}`);
    saveUser();
    localStorage.setItem('tyetapay_users',JSON.stringify(users));
    alert(msg);
    loadDashboard();
  }

  function loadAdmin(){
    let html = "<table><tr><th>Nama</th><th>Email</th><th>Saldo</th><th>Password</th><th>Aksi</th></tr>";
    Object.values(users).forEach(u=>{
      html += `<tr>
        <td>${u.name}</td>
        <td>${u.email}</td>
        <td>Rp ${u.balance.toLocaleString()}</td>
        <td>${u.pass}</td>
        <td>
          <button onclick="adminTopup('${u.email}')">Isi Saldo</button>
          <button onclick="banUser('${u.email}')">${u.banned?'Unban':'Ban'}</button>
        </td>
      </tr>`;
    });
    html += "</table>";
    document.getElementById('admin-userlist').innerHTML = html;
    showAdmin();
  }

  function adminTopup(email){
    const amount = parseInt(prompt('Jumlah top up untuk '+email+' (Rp)'));
    if(isNaN(amount)||amount<=0) return alert('Jumlah tidak valid!');
    users[email].balance += amount;
    users[email].history.unshift(`+ Rp${amount.toLocaleString()} (Top up admin)`);
    localStorage.setItem('tyetapay_users', JSON.stringify(users));
    alert('Saldo berhasil ditambahkan!');
    loadAdmin();
  }

  function banUser(email){
    users[email].banned = !users[email].banned;
    localStorage.setItem('tyetapay_users', JSON.stringify(users));
    alert(users[email].banned ? 'Akun dibanned!' : 'Akun di-unban!');
    loadAdmin();
  }

  function logout(){
    localStorage.removeItem('tyetapay_current');
    currentUser=null;
    showLogin();
  }

  if(currentUser){
    if(currentUser.email===ADMIN_EMAIL) loadAdmin();
    else loadDashboard();
  } else showLogin();
</script>

</body>
</html>
